{% comment %}
  https://shopify.dev/docs/storefronts/themes/product-merchandising/recommendations/complementary-products
{% endcomment %}

{%- unless recommendations.performed -%}
  <div class="px-4 my-4">
    <h2 class="mb-4">You may also like</h2>

    <div id="product_recommendations-{{ section.id }}-{{ product.id }}">
      {% comment %} results are appended here {% endcomment %}
    </div>

    <form
      x-init="setTimeout(() => $el.requestSubmit())"
      x-target="product_recommendations-{{ section.id }}-{{ product.id }}"
      action="{{ routes.product_recommendations_url }}"
    >
      <input type="hidden" name="section_id" value="{{ section.id }}">
      <input type="hidden" name="product_id" value="{{ product.id }}">
      <input type="hidden" name="limit" value="{{ section.settings.limit | default: 4 }}">
      <input type="hidden" name="intent" value="{{ section.settings.intent | default: 'related' }}">
    </form>
  </div>
{%- else -%}
  <ul id="product_recommendations-{{ section.id }}-{{ product.id }}" class="grid grid-cols-4 gap-4">
    {%- for product in recommendations.products -%}
      <li>
        {% render 'product-card', product: product %}
      </li>
    {%- endfor -%}
  </ul>
{%- endunless -%}
